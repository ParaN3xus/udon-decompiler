# AGENTS

This file provides quick, repo-specific guidance for automated agents.

## Start here
- Read `docs/for-llm/CONTEXT.md` for architecture and workflows.
- Skim `docs/dev/structure/overview.typ` for the official flow overview.

## Project rules of thumb
- Do not hand-edit dumped JSON blocks in `tests/cases/**.md`; they are regenerated by CI.
- Keep new files ASCII when possible.
- Follow existing naming and module boundaries (loaders/parsers/analysis/codegen).
- Control-flow structuring is SCFG-based (`analysis/scfg_adapter.py`, `codegen/scfg_emitter.py`).

## Key commands
- Install deps (dev): `uv sync --group dev`
- Run lint: `uv run ruff check .`
- Type check: `uv run pyright`
- Tests: `uv run pytest` (use `-k` and `-vv` as needed)
- Update snapshots: `uv run pytest --snapshot-update`

## Testing prerequisites
- `UdonModuleInfo.json` must exist (or set `UDON_MODULE_INFO` to its path).

## Typical test-case update flow
1) Add/update C# in `tests/cases/**.md`.
2) Push so CI updates dumped JSON blocks.
3) Locally run snapshot update: `pytest --snapshot-update`.
4) Verify generated C# and commit snapshot updates.

## Workflows to know
- `compile-test-cases.yml`: compiles markdown cases in Unity and writes dumped JSON back.
- `ci.yml`: ruff + pyright + pytest.
- `docs.yml`: builds Typst docs with shiroa.
- `generate-udon-module-info.yml`: extracts module info from Unity.
